{% extends "base.html" %}

{% block html_imports %}
  <link rel="import" href="/static/elements/chromedash-app.html">
  <link rel="import" href="/static/elements/chromedash-metadata.html">
{% endblock %}

{% block subheader %}
<div id="subheader">
  <div>
    <h2>Builds</h2>
  </div>
  <div>
    <h2>Features</h2>
  </div>
  <div class="search">
    <input type="search" placeholder="Search">
  </div>
  <div>
    {% if user.is_whitelisted %}
      <a href="/admin/features/new">Add a new feature</a>
    {% endif %}
  </div>
</div>
{% endblock %}

{% block content %}
<section id="panels">
<nav>
  <chromedash-metadata></chromedash-metadata>
</nav>
<chromedash-app {% if user.is_whitelisted %}whitelisted{% endif %}></chromedash-app>
</section>

<!--
{% load verbatim %}

{% verbatim %}
<table ng-controller="DataTableController" id="data-table">
  <tr class="headerRow">
    <th ng-repeat="col in data.cols">{{col.label}}</th>
  </tr>
  <tr ng-repeat="row in data.rows">
    <td ng-repeat="cell in row.c">{{cell.v}}</td>
  </tr>
</table>
{% endverbatim %} -->

{% endblock %}

{% block js %}
<script>
(function() {

var chromedashApp = document.querySelector('chromedash-app');
document.addEventListener('WebComponentsReady', function(e) {
  chromedashApp.features = {{features|safe}}; // Filled from server.
});

var search = document.querySelector('.search [type="search"]');
search.addEventListener('keyup', function(e) {
  chromedashApp.filter(e);
});
// Clear input when user clicks the 'x' button.
search.addEventListener('click', function(e) {
  if (!e.target.value) {
    chromedashApp.filter(e);
  }
});

})();
</script>
{% endblock %}
